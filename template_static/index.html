<!DOCTYPE html>
<html>
  <head>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>Hello world</title>
      <link rel="stylesheet" href="/style/style.css"/>
      <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
      <script src="/lib/jquery-2.1.1.min.js"></script>
      <script src="/lib/core.js"></script>
      <script src="/js/fake.js"></script>
      <script src="/js/user.js"></script>
      <script>
          var current = 'home';
          $(document).ready(function() {
              $('#home').removeClass('screen');
          });

          function goto(page) {
              $('#' + current).addClass('screen');
              $('#' + page).removeClass('screen');
              current = page;
          }

          function loadAdminScreen() {
              $.post('/admin', JSON.stringify({}))
          }

          function adminPage(page) {
              $.post('/admin/page', JSON.stringify({page: page}))
          }

          function addCategory() {
              $.post('/admin/category/add', JSON.stringify({name: $('#categoryName').val()}))
          }

          function addItem() {
              $.post('/admin/item/add', JSON.stringify({
                  name: $('#addItemName').val(),
                  price: $('#addItemPrice').val(),
                  stock: $('#addItemStock').val(),
                  image: $('#addItemUrl').val(),
                  cid: $('#addItemCategory').val()
              }))
          }

          function categories() {
              $.post('/categories/list', JSON.stringify({}))
          }

          function setCategory(cid) {
              $.post('/items/list', JSON.stringify({cid: cid}))
          }

          function selectItem(iid) {
              $.post('/items/select', JSON.stringify({iid: iid}))
          }

          function removeItem(iid) {
              $.post('/items/remove', JSON.stringify({iid: iid}))
          }

          function buyBasket() {
              $.post('/buy', JSON.stringify({}))
          }

      </script>
      <script src="/js/events.js"></script>
  </head>
<body>
    <!--
    BEGIN HOME SCREEN
    -->
    <div id="home" class="screen">
        <h1>Please scan your student id</h1>
        <ul>
            <li><a href="#" onclick="goto('login')">Login with username and password (not functional)</a></li>
            <li><a href="#" onclick="fakeScan(0)">Fake scan uid (0, admin)</a></li>
            <li><a href="#" onclick="fakeScan(1)">Fake scan uid (1, student 1)</a></li>
            <li><a href="#" onclick="fakeScan(2)">Fake scan uid (2, unkown card)</a></li>
        </ul>
    </div>
    <!--
    END HOME SCREEN
    -->
    <!--
    BEGIN NEW USER SCREEN
    -->
    <div id="newUser" class="screen">
        <h1>Please fill the form below to register as a new user (todo errors)</h1>
        <form>
            <input placeholder="Name" type="text" id="register_name" /><br />
            <input placeholder="s1234567" type="text" id="register_studentnr" /><br />
            <input placeholder="password" type="password" id="register_password" /><br />
            <input type="button" value="Register.." onClick="register()"/><br />
        </form>
        <br />
        <a href="#" onclick="goto('home')">go back</a>
    </div>
    <!--
    END NEW USER SCREEN
    -->
    <!--
    BEGIN LOGIN SCREEN
    -->
    <div id="login" class="screen">
        <h1>Please enter your student number and password (not functional)</h1>
        <form>
            <input placeholder="s1234567" type="text" id="studentnr" /><br />
            <input placeholder="password" type="password" id="password" /><br />
            <input type="button" value="Login.." /><br />
        </form>
        <br />
        <a href="#" onClick="goto('home')">go back</a>
    </div>
    <!--
    END LOGIN SCREEN
    -->
    <!--
    BEGIN SHOP SCREEN
    -->
    <div id="authenticated" class="screen">
        <h1>Welcome back</h1>
        Page when logged in..
        <ul>
            <li id="authenticated_name"></li>
            <li id="authenticated_sid"></li>
            <li id="authenticated_type"></li>
            <li id="authenticated_balance"></li>
        </ul>
        <br />
        <div id="authCategories" class="screen"></div>
        <div id="authItems" class="screen"></div>
        <br />
        <div id="authBasket">
            <h1>Shopping Basket</h1>
            <ul id="basketList"></ul>
            <input type="button" value="Check out" onClick="buyBasket()" />
        </div>
        <a href="#" id="categoriesLink" class="screen" onClick="categories()">Categories</a><br />
        <a href="#" onClick="logout()">Logout</a>
    </div>
    <div id="admin_link" class="screen">
        <a href="#" onClick="loadAdminScreen()">Admin Panel</a>
    </div>
    <!--
    END SHOP SCREEN
    -->
    <!--
    BEGIN ADMIN SCREEN
    -->
    <div id="admin" class="screen">
        Whoohoo admin screen<br />
        <ul>
            <li><a href="#" onClick="adminPage('adminList')">Admin list</a></li>
            <li><a href="#" onClick="adminPage('userList')">User list</a></li>
            <li><a href="#" onClick="adminPage('keyList')">Key list</a></li>
            <li><a href="#" onClick="adminPage('categoryList')">Category list</a></li>
            <li><a href="#" onClick="adminPage('categoryAdd')">Category add</a></li>
            <li><a href="#" onClick="adminPage('productList')">Product list</a></li>
            <li><a href="#" onClick="adminPage('productAdd')">Add Product</a></li>
        </ul>
        <div id="adminList" class="screen">
            <h1>admin list</h1>
            <div id="adminListContent"></div>
        </div>
        <div id="userList" class="screen">
            <h1>User list</h1>
            <div id="userListContent"></div>
        </div>
        <div id="keyList" class="screen">
            <h1>Key list</h1>
            <div id="keyListContent"></div>
        </div>
        <div id="categoryList" class="screen">
            <h1>Category list</h1>
            <div id="categoryListContent"></div>
        </div>
        <div id="categoryAdd" class="screen">
            <h1>Add Category</h1>
            <form>
                <input type="text" placeholder="Category name" id="categoryName" /><br /><br />
                <input type="submit" value="Add Category" onClick="addCategory()">
            </form>
        </div>
        <div id="productList" class="screen">
            <h1>Product list</h1>
            <div id="productListContent"></div>
        </div>
        <div id="productAdd" class="screen">
            <h1>Add Product</h1>
            <form>
                <input style="width: 250px;" type="text" placeholder="Product Name exp. Bagel" id="addItemName" /><br />
                <select id="addItemCategory"></select><br />
                <input style="width: 250px;" type="text" placeholder="Price exp. 1,50" id="addItemPrice" /><br />
                <input style="width: 250px;" type="text" placeholder="Items in stock exp. 10" id="addItemStock" /><br />
                <input style="width: 250px;" type="text" placeholder="Image filename exp. bagels.jpg" id="addItemUrl" /><br /><br />
                <input type="submit" value="Add Product" onClick="addItem()">
            </form>
        </div>
        <a href="#" onClick="logout()">Logout</a>
    </div>
    <!--
    END ADMIN SCREEN
    -->
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script>
        // Event to show new user screen (unknown card)
        block('#newUser').newUser();
        events.connect('newUser', '#newUser');
        // Event when user is authenticated
        block('#authenticated').authenticatedUser();
        events.connect('authenticated', '#authenticated');
        block('#authCategories').categories();
        events.connect('categories', '#authCategories');
        block('#authItems').items();
        events.connect('items', '#authItems');
        block('#basketList').basket();
        events.connect('basket', '#basketList');
        // Event when user is logged out
        block('#home').logoutUser();
        events.connect('logout', '#home');
        // Event when admin panel should load
        block('#admin').admin();
        events.connect('admin', '#admin');
        block('#admin').adminpage();
        events.connect('adminpage', '#admin');
    </script>
</body>
</html>